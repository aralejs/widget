define("arale/widget/1.0.4/widget",["arale/base/1.0.1/base","arale/class/1.0.0/class","arale/events/1.0.0/events","$","./daparser","./auto-render"],function(e,t,n){function r(){return"widget-"+O++}function i(e){return"[object String]"===b.call(e)}function a(e){return"[object Function]"===b.call(e)}function s(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e){return R(document.documentElement,e)}function u(e){return e.charAt(0).toUpperCase()+e.substring(1)}function l(e){return a(e.events)&&(e.events=e.events()),e.events}function d(e,t){var n=e.match(_),r=n[1]+g+t.cid,i=n[2]||void 0;return i&&i.indexOf("{{")>-1&&(i=f(i,t)),{type:r,selector:i}}function f(e,t){return e.replace(C,function(e,n){for(var r,a=n.split("."),s=t;r=a.shift();)s=s===t.attrs?t.get(r):s[r];return i(s)?s:P})}function c(e){return null==e||(i(e)||p.isArray(e))&&0===e.length||p.isPlainObject(e)&&s(e)}var h=e("arale/base/1.0.1/base"),p=e("$"),m=e("./daparser"),v=e("./auto-render"),g=".delegate-events-",y="_onRender",w="data-widget-cid",A={},E=h.extend({propsInAttrs:["element","template","model","events"],element:null,template:"<div></div>",model:null,events:null,attrs:{id:"",className:"",style:{},parentNode:document.body},initialize:function(e){this.cid=r();var t=this._parseDataAttrsConfig(e);this.initAttrs(e,t),this.parseElement(),this.initProps(),this.delegateEvents(),this.setup(),this._stamp()},_parseDataAttrsConfig:function(e){var t,n;return e&&(t=p(e.element)),t&&t[0]&&!v.isDataApiOff(t)&&(n=m.parseElement(t)),n},parseElement:function(){var e=this.element;if(e?this.element=p(e):this.get("template")&&this.parseElementFromTemplate(),!this.element||!this.element[0])throw Error("element is invalid")},parseElementFromTemplate:function(){this.element=p(this.get("template"))},initProps:function(){},delegateEvents:function(e,t){if(e||(e=l(this)),e){if(i(e)&&a(t)){var n={};n[e]=t,e=n}for(var r in e)if(e.hasOwnProperty(r)){var s=d(r,this),o=s.type,u=s.selector;(function(e,t){var n=function(n){a(e)?e.call(t,n):t[e](n)};u?t.element.on(o,u,n):t.element.on(o,n)})(e[r],this)}return this}},undelegateEvents:function(e){var t={};return 0===arguments.length?t.type=g+this.cid:t=d(e,this),this.element.off(t.type,t.selector),this},setup:function(){},render:function(){this.rendered||(this._renderAndBindAttrs(),this._parseWidgetExtension(),this.rendered=!0);var e=this.get("parentNode");return e&&!o(this.element[0])&&this.element.appendTo(e),this},_renderAndBindAttrs:function(){var e=this,t=e.attrs;for(var n in t)if(t.hasOwnProperty(n)){var r=y+u(n);if("function"==typeof this[r]){var i=this.get(n);c(i)||this[r](i,void 0,n),function(t){e.on("change:"+n,function(n,r,i){e[t](n,r,i)})}(r)}else e.on("change:"+n,function(){e.renderPartial(),e._parseWidgetExtension()})}},renderPartial:function(){},_parseWidgetExtension:function(){},_onRenderId:function(e){this.element.attr("id",e)},_onRenderClassName:function(e){this.element.addClass(e)},_onRenderStyle:function(e){this.element.css(e)},_stamp:function(){var e=this.cid;this.element.attr(w,e),A[e]=this},$:function(e){return this.element.find(e)},destroy:function(){this.undelegateEvents(),delete A[this.cid],this.element&&(this.element.off(),this.element=null),E.superclass.destroy.call(this)}});p(window).unload(function(){for(var e in A)A[e].destroy()}),E.query=function(e){var t,n=p(e).eq(0);return n&&(t=n.attr(w)),A[t]},E.autoRender=v.autoRender,E.autoRenderAll=v.autoRenderAll,E.StaticsWhiteList=["autoRender"],n.exports=E;var b=Object.prototype.toString,O=0,R=p.contains||function(e,t){return!!(16&e.compareDocumentPosition(t))},_=/^(\S+)\s*(.*)$/,C=/{{([^}]+)}}/g,P="INVALID_SELECTOR"}),define("arale/widget/1.0.4/daparser",["$"],function(e,t){function n(e){return e.toLowerCase().replace(s,function(e,t){return(t+"").toUpperCase()})}function r(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];if("string"!=typeof n)continue;o.test(n)?(n=n.replace(/'/g,'"'),e[t]=r(u(n))):e[t]=i(n)}return e}function i(e){if("false"===e.toLowerCase())e=!1;else if("true"===e.toLowerCase())e=!0;else if(/\d/.test(e)&&/[^a-z]/i.test(e)){var t=parseFloat(e);t+""===e&&(e=t)}return e}var a=e("$");t.parseElement=function(e,t){e=a(e)[0];var i={};if(e.dataset)i=a.extend({},e.dataset);else for(var s=e.attributes,o=0,u=s.length;u>o;o++){var l=s[o],d=l.name;0===d.indexOf("data-")&&(d=n(d.substring(5)),i[d]=l.value)}return t===!0?i:r(i)};var s=/-([a-z])/g,o=/^\s*[\[{].*[\]}]\s*$/,u=this.JSON?JSON.parse:a.parseJSON}),define("arale/widget/1.0.4/auto-render",["$"],function(e,t){var n=e("$"),r="data-widget-auto-rendered";t.autoRender=function(e){return new this(e).render()},t.autoRenderAll=function(e,i){"function"==typeof e&&(i=e,e=null),e=n(e||document.body);var a=[],s=[];e.find("[data-widget]").each(function(e,n){t.isDataApiOff(n)||(a.push(n.getAttribute("data-widget").toLowerCase()),s.push(n))}),a.length&&seajs.use(a,function(){for(var e=0;arguments.length>e;e++){var t=arguments[e],a=n(s[e]);a.attr(r)||(t.autoRender&&t.autoRender({element:a,renderType:"auto"}),a.attr(r,"true"))}i&&i()})};var i="off"===n(document.body).attr("data-api");t.isDataApiOff=function(e){var t=n(e).attr("data-api");return"off"===t||"on"!==t&&i}});
